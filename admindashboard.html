<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Disaster Alert Dashboard</title>
  <link rel="stylesheet" href="style3.css">
</head>
<body>

  <header class="dashboard-header">
    <h1>Send Disaster Alerts</h1>
    <a href="front.html" class="logout-btn">Logout</a>
  </header>

  <main class="dashboard-container">

    <section class="alert-form">
      <h2>üì¢ Send New Alert</h2>
      <p class="subtitle">Select region and disaster type to broadcast alert.</p>

      <!-- ‚úÖ FORM ID ADDED -->
      <form id="alertForm">

        <label for="location">Select Location</label>
        <select id="location" required>
          <option value="">-- Choose Location --</option>
          <option value="Mumbai">Mumbai</option>
          <option value="Chennai">Chennai</option>
          <option value="Delhi">Delhi</option>
          <option value="Kolkata">Kolkata</option>
          <option value="Bengaluru">Bengaluru</option>
          <option value="Hyderabad">Hyderabad</option>
        </select>

        <label for="disaster">Select Disaster Type</label>
        <select id="disaster" required>
          <option value="">-- Choose Disaster --</option>
          <option value="Flood">Flood</option>
          <option value="Earthquake">Earthquake</option>
          <option value="Fire">Fire</option>
          <option value="Cyclone">Cyclone</option>
          <option value="Landslide">Landslide</option>
        </select>

        <label for="message">Write Alert Message</label>
        <textarea
          id="message"
          rows="5"
          placeholder="Enter the message to be sent..."
          required
        ></textarea>

        <button type="submit" class="send-btn">Send Alert</button>

      </form>
    </section>

  </main>

  <!-- ‚úÖ SCRIPT -->
  <script>
    document.getElementById("alertForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const location = document.getElementById("location").value;
      const disaster = document.getElementById("disaster").value;
      const message = document.getElementById("message").value;

      if (!location || !disaster || !message) {
        alert("All fields are required");
        return;
      }

      try {
        const res = await fetch("http://localhost:5000/api/sendalert/send", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            location,
            disaster,
            message
          })
        });

        const data = await res.json();

        if (!res.ok) {
          alert(data.error || "Failed to send alert");
          return;
        }

        alert("‚úÖ Alert sent successfully!");
        document.getElementById("alertForm").reset();

      } catch (err) {
        console.error(err);
        alert("‚ùå Server not reachable");
      }
    });
  </script>

</body>
</html>
